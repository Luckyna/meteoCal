<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:p="http://primefaces.org/ui">

    <ui:composition template="/template.xhtml">

        <f:metadata>
            <f:viewParam name="id" value="#{viewEvent.eventId}"/>
            <f:viewAction action="#{viewEvent.findEventById}"/>
        </f:metadata>

        <ui:define name="title">event</ui:define>

        <ui:define name="content">

            <h1><h:outputText value="#{viewEvent.eventToShow.title}" /></h1>

            <h:outputLabel value="Title:" /><h:outputText value="#{viewEvent.eventToShow.title}"/><br/>
            <h:outputLabel value="Starts at:" /><h:outputText value="#{viewEvent.eventToShow.formattedStartDate}"/><br/>
            <h:outputLabel value="Ends at:" /><h:outputText value="#{viewEvent.eventToShow.formattedEndDate}"/><br/>
            <h:outputLabel value="Location:" /><h:outputText value="#{viewEvent.eventToShow.location}"/><br/>
            <h:outputLabel value="Description:" /><h:outputText value="#{viewEvent.eventToShow.description}"/><br/>
            <h:outputLabel value="isOutdoor:" /><h:outputText value="#{viewEvent.eventToShow.isOutdoor}"/><br/>
            <h:outputLabel value="Owner:" /><h:outputText value="#{viewEvent.eventToShow.owner.name}"/><br/>
            <h:outputLabel value="Public:" /><h:outputText value="#{viewEvent.publicAccess}"/><br/>

            <p:tabView rendered="#{viewEvent.showInvitees}">
                <p:tab title="Partecipants:">
                    <c:forEach items="#{viewEvent.acceptedInvitations}" var="yesUser">
                        <p:outputLabel value="#{yesUser.email}"/><br/>
                    </c:forEach>
                </p:tab>
                <p:tab title="Declined:">
                    <c:forEach items="#{viewEvent.declinedInvitations}" var="noUser">
                        <p:outputLabel value="#{noUser.email}"/><br/>
                    </c:forEach>
                </p:tab>
                <p:tab title="No Asnwer">
                    <c:forEach items="#{viewEvent.noAnswerInvitations}" var="bhoUser">
                        <p:outputLabel value="#{bhoUser.email}"/><br/>
                    </c:forEach>
                </p:tab>
                <p:tab title="Public Join" rendered="#{viewEvent.publicAccess}">
                    <c:forEach items="#{viewEvent.publicJoinUsers}" var="publicUser">
                        <p:outputLabel value="#{publicUser.email}"/><br/>
                    </c:forEach>
                </p:tab>
            </p:tabView>

            <h:form>

                <h:commandButton value="Partecipaa" rendered="#{!viewEvent.hasAnswered and viewEvent.publicAccess and !viewEvent.allowedToModify}" 
                                 action="#{viewEvent.partecipate()}"/><br/>

                <p:splitButton id="button1" value="#{viewEvent.answerMessage}" rendered="#{viewEvent.hasAnswered and viewEvent.publicAccess and !viewEvent.allowedToModify}">
                    <p:menuitem value="Non Partecipa" update="button1" actionListener="#{viewEvent.doDecline()}" rendered="#{viewEvent.publicJoin}" />
                    <p:menuitem value="partecipaa" update="button1" actionListener="#{viewEvent.doPartecipate()}" rendered="#{!viewEvent.publicJoin}" />
                </p:splitButton>


                <p:splitButton id="button2" value="#{viewEvent.answerMessage}" rendered="#{!viewEvent.publicAccess and !viewEvent.allowedToModify}">
                    <p:menuitem value="Partecipo" update="button2" actionListener="#{viewEvent.doPartecipate()}" rendered="#{!viewEvent.hasAnswered or !viewEvent.partecipate}" />
                    <p:menuitem value="Non Partecipo" update="button2" actionListener="#{viewEvent.doDecline()}" rendered="#{!viewEvent.hasAnswered or viewEvent.partecipate}" />
                </p:splitButton>

            </h:form>

            <p:button value="modifica" rendered="#{viewEvent.allowedToModify}" 
                      outcome="/s/manageEvent.xhtml?idEvent=#{viewEvent.eventId}" /><br/>
        </ui:define>

    </ui:composition>
</html>
